swagger: '2.0'
info:
  title: Auto Test Case API
  version: '1.0'
tags:
  - name: Project
    description: Project management endpoints
  - name: Document
    description: Document management endpoints
  - name: Task
    description: Task management endpoints
  - name: Scenario
    description: Test scenario management endpoints
  - name: TestCase
    description: Test case management endpoints
  - name: TestRun
    description: Test run history management endpoints
paths:
  /api/ping:
    get:
      summary: ping function in ping controller
      tags: [Project]
      operationId: controllers.ping.ping
      responses:
        '200':
          description: Successful operation
  /api/project/create:
    post:
      summary: create project
      tags: [Project]
      consumes:
        - application/json
        - multipart/form-data
      parameters:
        - name: name
          in: formData
          required: true
          type: string
          description: Project name
        - name: description
          in: formData
          required: false
          type: string
          description: Project description
        - name: owner
          in: formData
          required: false
          type: string
          description: Project owner
        - name: is_current
          in: formData
          required: false
          type: boolean
          description: Mark the first uploaded document as current
        - name: file
          in: formData
          required: true
          type: file
          description: Project document(s)
          collectionFormat: multi
      operationId: controllers.project.create
      responses:
        '200':
          description: Successful operation
  /api/project/get:
    get:
      summary: get project by id (includes tasks and test scenarios)
      tags: [Project]
      produces:
        - application/json
      parameters:
        - name: id
          in: query
          required: true
          type: string
          description: The ID of the project to retrieve
      operationId: controllers.project.get
      responses:
        '200':
          description: Successful operation
          schema:
            type: object
            properties:
              project_id:
                type: string
              name:
                type: string
              tasks:
                type: array
                items:
                  type: object
                  properties:
                    task_id:
                      type: string
                    test_scenarios:
                      type: array
                      items:
                        type: object
                        properties:
                          scenario:
                            type: string
                          test_cases:
                            type: array
                            items:
                              type: object
                              properties:
                                test_case:
                                  type: string
                                requirement:
                                  type: string
                                test_objective:
                                  type: string
                                scenario:
                                  type: string
                                expected_result:
                                  type: string
  /api/project/delete:
    delete:
      summary: delete project by id
      tags: [Project]
      produces:
        - application/json
      parameters:
        - name: id
          in: query
          required: true
          type: string
          description: The ID of the project to delete
      operationId: controllers.project.delete
      responses:
        '200':
          description: Successful operation

  /api/projects:
    get:
      summary: get all project
      tags: [Project]
      produces:
        - application/json
      operationId: controllers.project.list
      responses:
        '200':
          description: Successful operation

  /api/project/update:
    put:
      summary: update project information by id
      tags: [Project]
      operationId: controllers.project.update
      responses:
        '200':
          description: Successful operation

  /api/project/document/upload:
    post:
      summary: upload document for project
      tags: [Document]
      operationId: controllers.document.upload_document
      responses:
        '200':
          description: Successful operation

  /api/project/document/list:
    get:
      summary: list documents for a project
      tags: [Document]
      operationId: controllers.document.get_documents
      responses:
        '200':
          description: Successful operation

  /api/project/document/delete:
    delete:
      summary: delete document by id
      tags: [Document]
      operationId: controllers.document.delete_document
      responses:
        '200':
          description: Successful operation

  /api/project/document/list_by_project:
    get:
      summary: List all documents for a project
      tags: [Document]
      produces:
        - application/json
      parameters:
        - name: project_id
          in: query
          required: true
          type: string
          description: The ID of the project to list documents for
      operationId: controllers.document.get_documents_by_project
      responses:
        '200':
          description: Successful operation
  /api/project/document/detail:
    get:
      summary: Get detail for a document
      tags: [Document]
      produces:
        - application/json
      parameters:
        - name: document_id
          in: query
          required: true
          type: string
          description: The ID of the document to retrieve
      operationId: controllers.document.get_document_detail
      responses:
        '200':
          description: Successful operation

  /api/task/create:
    post:
      summary: create task
      tags: [Task]
      produces:
        - application/json
      parameters:
        - name: body
          in: body
          required: true
          schema:
            type: object
            properties:
              project_id:
                type: string
                format: uuid
                example: "<project_id>"
              task_name:
                type: string
                example: "Feature: Practice Test Automation Login"
              url:
                type: string
                format: uri
                example: "https://practicetestautomation.com/practice-test-login"
              context:
                type: array
                items:
                  type: string
                example:
                  - "Open page"
                  - "Type username incorrectUser into Username field"
                  - "Type password Password123 into Password field"
                  - "Click on button by XPATH = \"//button[@id='submit']\""
                  - "Verify error message is displayed"
              output:
                type: string
                example: "Your username is invalid"
            required:
              - project_id
              - task_name
              - url
              - context
              - output
      operationId: controllers.task.create
      responses:
        '200':
          description: Successful operation
  /api/task/execute:
    post:
      summary: execute task by project id and task id
      tags: [Task]
      parameters:
        - name: body
          in: body
          required: true
          schema:
            type: object
            properties:
              project_id:
                type: string
                example: "<project_id>"
              task_id:
                type: string
                example: "<task_id>"
            required:
              - task_id
              - project_id
      operationId: controllers.task.ex_task
      responses:
        '200':
          description: Successful operation
  /api/task/get:
    get:
      summary: get task by id (includes test scenarios)
      tags: [Task]
      produces:
        - application/json
      parameters:
        - name: project_id
          in: query
          required: true
          type: string
          description: The ID of the project to retrieve
        - name: task_id
          in: query
          required: true
          type: string
          description: The ID of the task to retrieve
      operationId: controllers.task.get
      responses:
        '200':
          description: Successful operation
          schema:
            type: object
            properties:
              task_id:
                type: string
              test_scenarios:
                type: array
                items:
                  type: object
                  properties:
                    scenario:
                      type: string
                    test_cases:
                      type: array
                      items:
                        type: object
                        properties:
                          test_case:
                            type: string
                          requirement:
                            type: string
                          test_objective:
                            type: string
                          scenario:
                            type: string
                          expected_result:
                            type: string

  /api/tasks:
    get:
      summary: get tasks by project id
      tags: [Task]
      produces:
        - application/json
      parameters:
        - name: project_id
          in: query
          required: true
          type: string
          description: The ID of the project to retrieve
      operationId: controllers.task.get_all
      responses:
        '200':
          description: Successful operation

  /api/task/screenshots:
    get:
      summary: get screenshots by id
      produces:
        - application/json
      parameters:
        - name: project_id
          in: query
          required: true
          type: string
          description: The ID of the project to retrieve
        - name: task_id
          in: query
          required: true
          type: string
          description: The ID of the task to retrieve
      operationId: controllers.task.get_screenshots
      responses:
        '200':
          description: Successful operation

  /api/task/screenshot:
    get:
      summary: get screenshots by image path
      produces:
        - application/json
      parameters:
        - name: path
          in: query
          required: true
          type: string
          description: The path image to retrieve
      operationId: controllers.task.get_screenshot
      responses:
        '200':
          description: Successful operation

  /api/task/delete:
    delete:
      summary: delete task by id
      produces:
        - application/json
      parameters:
        - name: project_id
          in: query
          required: true
          type: string
          description: The ID of the project to delete
        - name: task_id
          in: query
          required: true
          type: string
          description: The ID of the task to delete
      operationId: controllers.task.delete
      responses:
        '200':
          description: Successful operation

  /api/task/update:
    put:
      summary: update task information by id
      produces:
        - application/json
      operationId: controllers.task.update
      responses:
        '200':
          description: Successful operation

  /api/scenario/save:
    post:
      summary: Save all scenarios for a project
      tags: [Scenario]
      consumes:
        - application/json
      parameters:
        - name: body
          in: body
          required: true
          schema:
            type: object
            properties:
              project_id:
                type: string
              scenarios:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: string
                    name:
                      type: string
                    description:
                      type: string
                    lastUpdated:
                      type: string
                    version:
                      type: string
                    priority:
                      type: string
                      enum: [High, Medium, Low]
                    testCases:
                      type: array
                      items:
                        type: object
                        properties:
                          id:
                            type: string
                          name:
                            type: string
                          expectedResult:
                            type: string
                          steps:
                            type: array
                            items:
                              type: string
                          tags:
                            type: array
                            items:
                              type: string
                          version:
                            type: string
                          lastUpdated:
                            type: string
                          testDataSets:
                            type: array
                            items:
                              type: object
                              properties:
                                id:
                                  type: string
                                name:
                                  type: string
                                inputData:
                                  type: object
                                expectedOutput:
                                  type: object
                                version:
                                  type: string
                                lastUpdated:
                                  type: string
            example:
              project_id: "your-project-id"
              scenarios:
                - id: "scenario-uuid"
                  name: "Login Performance"
                  description: "Simulate 20 concurrent users logging in."
                  lastUpdated: "2024-07-01T12:00:00Z"
                  version: "1.0"
                  priority: "High"
                  testCases:
                    - id: "case-uuid"
                      name: "TC_001"
                      expectedResult: "Average login response time should be less than 3 seconds."
                      steps: ["Step 1", "Step 2"]
                      tags: ["performance", "login"]
                      version: "1.0"
                      lastUpdated: "2024-07-01T12:00:00Z"
                      testDataSets:
                        - id: "dataset-uuid"
                          name: "Valid User"
                          inputData: { "username": "user1", "password": "pass" }
                          expectedOutput: { "status": "success" }
                          version: "1.0"
                          lastUpdated: "2024-07-01T12:00:00Z"
      operationId: controllers.scenario.save_scenarios
      responses:
        '200':
          description: Scenarios saved
  /api/scenario/list:
    get:
      summary: List all scenarios for a project
      tags: [Scenario]
      parameters:
        - name: project_id
          in: query
          required: true
          type: string
      operationId: controllers.scenario.get_scenarios
      responses:
        '200':
          description: List of scenarios
          schema:
            type: array
            items:
              type: object
              properties:
                id:
                  type: string
                name:
                  type: string
                description:
                  type: string
                lastUpdated:
                  type: string
                version:
                  type: string
                priority:
                  type: string
                  enum: [High, Medium, Low]
                testCases:
                  type: array
                  items:
                    type: object
                    properties:
                      id:
                        type: string
                      name:
                        type: string
                      expectedResult:
                        type: string
                      steps:
                        type: array
                        items:
                          type: string
                      tags:
                        type: array
                        items:
                          type: string
                      version:
                        type: string
                      lastUpdated:
                        type: string
                      testDataSets:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: string
                            name:
                              type: string
                            inputData:
                              type: object
                            expectedOutput:
                              type: object
                            version:
                              type: string
                            lastUpdated:
                              type: string
  /api/scenario/update:
    put:
      summary: Update a scenario for a project
      tags: [Scenario]
      consumes:
        - application/json
      parameters:
        - name: body
          in: body
          required: true
          schema:
            type: object
            properties:
              project_id:
                type: string
              scenario_id:
                type: string
              scenario_data:
                type: object
      operationId: controllers.scenario.update_scenario
      responses:
        '200':
          description: Scenario updated
  /api/scenario/delete:
    delete:
      summary: Delete a scenario for a project
      tags: [Scenario]
      parameters:
        - name: project_id
          in: query
          required: true
          type: string
        - name: scenario_id
          in: query
          required: true
          type: string
      operationId: controllers.scenario.delete_scenario
      responses:
        '200':
          description: Scenario deleted

  /api/scenario/get:
    get:
      summary: Get a specific scenario by ID
      tags: [Scenario]
      parameters:
        - name: project_id
          in: query
          required: true
          type: string
          description: The ID of the project
        - name: scenario_id
          in: query
          required: true
          type: string
          description: The ID of the scenario
      operationId: controllers.scenario.get_scenario
      responses:
        '200':
          description: Scenario details with test cases
          schema:
            type: object
            properties:
              id:
                type: string
              name:
                type: string
              description:
                type: string
              test_cases:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: string
                    title:
                      type: string
                    description:
                      type: string
                    steps:
                      type: array
                      items:
                        type: string
                    expected_result:
                      type: string
                    status:
                      type: string
                      enum: [untested, passed, failed]
                    version:
                      type: string
                    created_at:
                      type: string
                      format: date-time
                    updated_at:
                      type: string
                      format: date-time

  /api/test_case/save:
    post:
      summary: Save test cases for a scenario
      tags: [TestCase]
      consumes:
        - application/json
      parameters:
        - name: body
          in: body
          required: true
          schema:
            type: object
            properties:
              project_id:
                type: string
                description: The ID of the project
              scenario_id:
                type: string
                description: The ID of the scenario
              test_cases:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: string
                      description: Test case ID (optional, will be generated if not provided)
                    title:
                      type: string
                      description: Test case title
                    description:
                      type: string
                      description: Test case description
                    steps:
                      type: array
                      items:
                        type: string
                      description: Test steps
                    expected_result:
                      type: string
                      description: Expected result
                    status:
                      type: string
                      enum: [untested, passed, failed]
                      description: Test case status
                    version:
                      type: string
                      description: Version number
            required:
              - project_id
              - scenario_id
              - test_cases
            example:
              project_id: "project-123"
              scenario_id: "scenario-456"
              test_cases:
                - title: "Login with valid credentials"
                  description: "Test user login with correct username and password"
                  steps:
                    - "Navigate to login page"
                    - "Enter valid username"
                    - "Enter valid password"
                    - "Click login button"
                  expected_result: "User should be logged in successfully"
                  status: "untested"
                  version: "1.0"
      operationId: controllers.test_case.save_test_cases
      responses:
        '200':
          description: Test cases saved successfully
        '400':
          description: Bad request - missing required parameters
        '500':
          description: Internal server error

  /api/test_case/list:
    get:
      summary: Get all test cases for a scenario
      tags: [TestCase]
      parameters:
        - name: project_id
          in: query
          required: true
          type: string
          description: The ID of the project
        - name: scenario_id
          in: query
          required: true
          type: string
          description: The ID of the scenario
      operationId: controllers.test_case.get_test_cases
      responses:
        '200':
          description: List of test cases
          schema:
            type: array
            items:
              type: object
              properties:
                id:
                  type: string
                title:
                  type: string
                description:
                  type: string
                steps:
                  type: array
                  items:
                    type: string
                expected_result:
                  type: string
                status:
                  type: string
                  enum: [untested, passed, failed]
                version:
                  type: string
                created_at:
                  type: string
                  format: date-time
                updated_at:
                  type: string
                  format: date-time

  /api/test_case/create:
    post:
      summary: Create a new test case
      tags: [TestCase]
      consumes:
        - application/json
      parameters:
        - name: body
          in: body
          required: true
          schema:
            type: object
            properties:
              project_id:
                type: string
                description: The ID of the project
              scenario_id:
                type: string
                description: The ID of the scenario
              test_case_data:
                type: object
                properties:
                  title:
                    type: string
                    description: Test case title
                  description:
                    type: string
                    description: Test case description
                  steps:
                    type: array
                    items:
                      type: string
                    description: Test steps
                  expected_result:
                    type: string
                    description: Expected result
                  status:
                    type: string
                    enum: [untested, passed, failed]
                    description: Test case status
                  version:
                    type: string
                    description: Version number
            required:
              - project_id
              - scenario_id
              - test_case_data
      operationId: controllers.test_case.create_test_case
      responses:
        '200':
          description: Test case created successfully
        '400':
          description: Bad request - missing required parameters
        '500':
          description: Internal server error

  /api/test_case/update:
    put:
      summary: Update a specific test case
      tags: [TestCase]
      consumes:
        - application/json
      parameters:
        - name: body
          in: body
          required: true
          schema:
            type: object
            properties:
              project_id:
                type: string
                description: The ID of the project
              scenario_id:
                type: string
                description: The ID of the scenario
              test_case_id:
                type: string
                description: The ID of the test case
              update_data:
                type: object
                description: Data to update
                properties:
                  title:
                    type: string
                  description:
                    type: string
                  steps:
                    type: array
                    items:
                      type: string
                  expected_result:
                    type: string
                  status:
                    type: string
                    enum: [untested, passed, failed]
                  version:
                    type: string
            required:
              - project_id
              - scenario_id
              - test_case_id
              - update_data
      operationId: controllers.test_case.update_test_case
      responses:
        '200':
          description: Test case updated successfully
        '400':
          description: Bad request - missing required parameters
        '404':
          description: Test case not found
        '500':
          description: Internal server error

  /api/test_case/delete:
    delete:
      summary: Delete a specific test case
      tags: [TestCase]
      parameters:
        - name: project_id
          in: query
          required: true
          type: string
          description: The ID of the project
        - name: scenario_id
          in: query
          required: true
          type: string
          description: The ID of the scenario
        - name: test_case_id
          in: query
          required: true
          type: string
          description: The ID of the test case
      operationId: controllers.test_case.delete_test_case
      responses:
        '200':
          description: Test case deleted successfully
        '400':
          description: Bad request - missing required parameters
        '404':
          description: Test case not found
        '500':
          description: Internal server error

  /api/test_case/get:
    get:
      summary: Get a specific test case by ID
      tags: [TestCase]
      parameters:
        - name: project_id
          in: query
          required: true
          type: string
          description: The ID of the project
        - name: scenario_id
          in: query
          required: true
          type: string
          description: The ID of the scenario
        - name: test_case_id
          in: query
          required: true
          type: string
          description: The ID of the test case
      operationId: controllers.test_case.get_test_case
      responses:
        '200':
          description: Test case details
          schema:
            type: object
            properties:
              id:
                type: string
              title:
                type: string
              description:
                type: string
              steps:
                type: array
                items:
                  type: string
              expected_result:
                type: string
              status:
                type: string
                enum: [untested, passed, failed]
              version:
                type: string
              created_at:
                type: string
                format: date-time
              updated_at:
                type: string
                format: date-time
        '400':
          description: Bad request - missing required parameters
        '404':
          description: Test case not found
        '500':
          description: Internal server error

  /api/test_run/record:
    post:
      summary: Record a new test run
      tags: [TestRun]
      consumes:
        - application/json
      parameters:
        - name: body
          in: body
          required: true
          schema:
            type: object
            properties:
              project_id:
                type: string
                description: The ID of the project
              scenario_id:
                type: string
                description: The ID of the scenario
              test_case_id:
                type: string
                description: The ID of the test case
              executed_by:
                type: string
                description: User who executed the test
              status:
                type: string
                enum: [pass, fail, skipped]
                description: Test execution status
              logs:
                type: string
                description: Test execution logs
              attachment_url:
                type: string
                description: URL to test attachments (screenshots, etc.)
              version:
                type: string
                description: Version number
            required:
              - project_id
              - scenario_id
              - test_case_id
              - executed_by
              - status
            example:
              project_id: "project-123"
              scenario_id: "scenario-456"
              test_case_id: "test-case-789"
              executed_by: "tester@example.com"
              status: "pass"
              logs: "Test executed successfully at 2024-01-15 10:30:00"
              attachment_url: "https://example.com/screenshots/test-123.png"
              version: "1.0"
      operationId: controllers.test_run.record_test_run
      responses:
        '200':
          description: Test run recorded successfully
        '400':
          description: Bad request - missing required parameters
        '500':
          description: Internal server error

  /api/test_run/list_by_case:
    get:
      summary: Get all test runs for a specific test case
      tags: [TestRun]
      parameters:
        - name: project_id
          in: query
          required: true
          type: string
          description: The ID of the project
        - name: test_case_id
          in: query
          required: true
          type: string
          description: The ID of the test case
      operationId: controllers.test_run.get_test_runs_by_case
      responses:
        '200':
          description: List of test runs
          schema:
            type: array
            items:
              type: object
              properties:
                run_id:
                  type: string
                project_id:
                  type: string
                scenario_id:
                  type: string
                test_case_id:
                  type: string
                executed_by:
                  type: string
                executed_at:
                  type: string
                  format: date-time
                status:
                  type: string
                  enum: [pass, fail, skipped]
                logs:
                  type: string
                attachment_url:
                  type: string
                version:
                  type: string

  /api/test_run/latest:
    get:
      summary: Get the latest test run for a specific test case
      tags: [TestRun]
      parameters:
        - name: project_id
          in: query
          required: true
          type: string
          description: The ID of the project
        - name: test_case_id
          in: query
          required: true
          type: string
          description: The ID of the test case
      operationId: controllers.test_run.get_latest_test_run
      responses:
        '200':
          description: Latest test run details
          schema:
            type: object
            properties:
              run_id:
                type: string
              project_id:
                type: string
              scenario_id:
                type: string
              test_case_id:
                type: string
              executed_by:
                type: string
              executed_at:
                type: string
                format: date-time
              status:
                type: string
                enum: [pass, fail, skipped]
              logs:
                type: string
              attachment_url:
                type: string
              version:
                type: string
        '404':
          description: No test runs found

  /api/test_run/get:
    get:
      summary: Get a specific test run by run_id
      tags: [TestRun]
      parameters:
        - name: run_id
          in: query
          required: true
          type: string
          description: The ID of the test run
      operationId: controllers.test_run.get_test_run
      responses:
        '200':
          description: Test run details
          schema:
            type: object
            properties:
              run_id:
                type: string
              project_id:
                type: string
              scenario_id:
                type: string
              test_case_id:
                type: string
              executed_by:
                type: string
              executed_at:
                type: string
                format: date-time
              status:
                type: string
                enum: [pass, fail, skipped]
              logs:
                type: string
              attachment_url:
                type: string
              version:
                type: string
        '404':
          description: Test run not found

  /api/test_run/update:
    put:
      summary: Update a specific test run
      tags: [TestRun]
      consumes:
        - application/json
      parameters:
        - name: body
          in: body
          required: true
          schema:
            type: object
            properties:
              run_id:
                type: string
                description: The ID of the test run
              update_data:
                type: object
                description: Data to update
                properties:
                  status:
                    type: string
                    enum: [pass, fail, skipped]
                  logs:
                    type: string
                  attachment_url:
                    type: string
            required:
              - run_id
              - update_data
      operationId: controllers.test_run.update_test_run
      responses:
        '200':
          description: Test run updated successfully
        '400':
          description: Bad request - missing required parameters
        '404':
          description: Test run not found
        '500':
          description: Internal server error

  /api/test_run/delete:
    delete:
      summary: Delete a specific test run
      tags: [TestRun]
      parameters:
        - name: run_id
          in: query
          required: true
          type: string
          description: The ID of the test run
      operationId: controllers.test_run.delete_test_run
      responses:
        '200':
          description: Test run deleted successfully
        '400':
          description: Bad request - missing required parameters
        '404':
          description: Test run not found
        '500':
          description: Internal server error

  /api/test_run/list_by_scenario:
    get:
      summary: Get all test runs for a specific scenario
      tags: [TestRun]
      parameters:
        - name: project_id
          in: query
          required: true
          type: string
          description: The ID of the project
        - name: scenario_id
          in: query
          required: true
          type: string
          description: The ID of the scenario
      operationId: controllers.test_run.get_test_runs_by_scenario
      responses:
        '200':
          description: List of test runs for the scenario
          schema:
            type: array
            items:
              type: object
              properties:
                run_id:
                  type: string
                project_id:
                  type: string
                scenario_id:
                  type: string
                test_case_id:
                  type: string
                executed_by:
                  type: string
                executed_at:
                  type: string
                  format: date-time
                status:
                  type: string
                  enum: [pass, fail, skipped]
                logs:
                  type: string
                attachment_url:
                  type: string
                version:
                  type: string

  /api/test_run/list_by_project:
    get:
      summary: Get recent test runs for a project
      tags: [TestRun]
      parameters:
        - name: project_id
          in: query
          required: true
          type: string
          description: The ID of the project
        - name: limit
          in: query
          required: false
          type: integer
          default: 100
          description: Maximum number of test runs to return
      operationId: controllers.test_run.get_test_runs_by_project
      responses:
        '200':
          description: List of recent test runs for the project
          schema:
            type: array
            items:
              type: object
              properties:
                run_id:
                  type: string
                project_id:
                  type: string
                scenario_id:
                  type: string
                test_case_id:
                  type: string
                executed_by:
                  type: string
                executed_at:
                  type: string
                  format: date-time
                status:
                  type: string
                  enum: [pass, fail, skipped]
                logs:
                  type: string
                attachment_url:
                  type: string
                version:
                  type: string
